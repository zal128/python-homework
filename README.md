# 手势控制系统（Gesture Control System）

<div align="center">

[![Python](https://img.shields.io/badge/Python-3.8%2B-blue)](https://www.python.org/)
[![MediaPipe](https://img.shields.io/badge/MediaPipe-0.10.32-orange)](https://mediapipe.dev/)
[![OpenCV](https://img.shields.io/badge/OpenCV-4.13.0-green)](https://opencv.org/)

**基于MediaPipe的AI手势识别与智能控制系统**

</div>

---

## 项目简介

手势控制系统是一款基于Google MediaPipe框架开发的智能人机交互软件。通过普通摄像头实时捕捉手部动作，利用MediaPipe AI模型检测手部关键点，通过规则判断识别手势，并将其转换为电脑操作指令，实现无接触式智能控制。

### 核心优势

- **高准确率**：基于MediaPipe Tasks API进行手部关键点检测，配合规则判断实现手势识别
- **低延迟**：系统响应时间小于100毫秒，操作流畅无卡顿
- **多模式**：支持4种交互模式，智能场景自动切换
- **易用性**：图形化界面，提供手势教学功能，新手可快速上手
- **可扩展**：模块化设计，便于功能扩展和二次开发

---

## 功能特性

### 核心功能

#### 1. 四模式智能交互

| 模式                 | 触发方式         | 功能说明                      |
| -------------------- | ---------------- | ----------------------------- |
| **主模式**     | 默认模式         | 音量/亮度调节、截图、模式切换 |
| **鼠标模式**   | 手掌手势激活     | 鼠标移动、点击、拖拽控制      |
| **浏览器模式** | 自动检测浏览器   | 页面滚动、标签切换、前进后退  |
| **音乐模式**   | 自动检测音乐软件 | 播放控制、音量调节、切歌      |

#### 2. 智能场景检测

- **浏览器自动检测**：当浏览器获得焦点时自动切换
- **音乐软件检测**：检测到音乐播放时自动激活音乐模式
- **无缝切换**：智能场景识别，无需手动干预

#### 3. 8种标准手势

| 手势           | 主模式   | 鼠标模式 | 浏览器模式 | 音乐模式  |
| -------------- | -------- | -------- | ---------- | --------- |
| **1指**  | 音量+    | 鼠标移动 | 刷新页面   | 播放/暂停 |
| **2指**  | 音量-    | 左键点击 | 后退       | 下一首    |
| **3指**  | 亮度+    | 右键点击 | 前进       | 上一首    |
| **4指**  | 亮度-    | 双击     | 恢复标签   | 音量+     |
| **握拳** | 截图     | 退出模式 | 向下滚动   | 音量-     |
| **手掌** | 切换模式 | 退出模式 | -          | 退出模式  |
| **摇滚** | 截图     | -        | 切换标签   | -         |
| **点赞** | -        | -        | 向上滚动   | 喜欢歌曲  |

#### 4. 人性化设计

- **手势教学**：内置详细手势教程，新手快速入门
- **参数可调**：支持自定义灵敏度、冷却时间等参数
- **实时状态**：悬浮窗口显示当前模式、手势、音量、亮度
- **防误触**：手势冷却机制，避免连续误触发
- **自动保存**：用户设置自动持久化

---

## 技术架构

### 系统架构图

```
┌─────────────────────────────────────────────────────────────┐
│                    手势控制系统 (GUI)                        │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐   │
│  │ 启动控制 │  │ 系统设置 │  │ 使用教程 │  │ 手势教学 │   │
│  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘   │
└───────┼─────────────┼─────────────┼─────────────┼─────────┘
        │             │             │             │
        ▼             ▼             ▼             ▼
┌─────────────────────────────────────────────────────────────┐
│                   核心处理层 (Core)                         │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐   │
│  │手部追踪  │  │手势识别  │  │动作执行  │  │场景检测  │   │
│  │(AI模型)  │  │(规则判断)│  │(系统控制)│  │(智能切换)│   │
│  │MediaPipe │  │状态机    │  │          │  │          │   │
│  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘   │
└───────┼─────────────┼─────────────┼─────────────┼─────────┘
        │             │             │             │
        ▼             ▼             ▼             ▼
┌─────────────────────────────────────────────────────────────┐
│                   硬件/系统接口层 (Driver)                  │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐   │
│  │ 摄像头   │  │ 音频控制 │  │ 鼠标键盘 │  │ 屏幕控制 │   │
│  │ (OpenCV) │  │ (pycaw)  │  │(pyautogui)│  │ (sbc)    │   │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘   │
└─────────────────────────────────────────────────────────────┘
```

### 技术栈

| 类别               | 技术/库                   | 版本     | 用途                 |
| ------------------ | ------------------------- | -------- | -------------------- |
| **核心框架** | Python                    | 3.8+     | 编程语言             |
| **AI识别**   | MediaPipe                 | 0.10.32  | 手部关键点检测       |
| **图像处理** | OpenCV                    | 4.13.0   | 摄像头采集与图像处理 |
| **系统控制** | pycaw                     | 20251023 | Windows音频控制      |
|                    | pyautogui                 | 0.9.54   | 鼠标键盘模拟         |
|                    | screen-brightness-control | 0.26.0   | 屏幕亮度调节         |
| **GUI界面**  | Tkinter                   | 内置     | 图形用户界面         |
| **辅助工具** | numpy                     | 2.4.1    | 数值计算             |
|                    | Pillow                    | 12.1.0   | 图像处理             |
|                    | psutil                    | 7.2.2    | 进程检测             |
|                    | mss                       | 10.1.0   | 屏幕截图             |

---

## 快速开始

### 前置要求

- Python 3.8 或更高版本
- 摄像头设备（内置或外置）
- Windows操作系统（部分功能需要Windows API）

### 安装步骤

#### 方法一：手动安装

**步骤1：克隆项目**

```bash
git clone <repository-url>
cd gesture-control-system
```

**步骤2：安装依赖**

```bash
pip install -r requirements.txt
```

**步骤3：启动程序**

```bash
python launcher.py
```

#### 方法二：静默启动（无黑窗口）

**步骤一：安装依赖**

```bash
pip install -r requirements.txt
```

**步骤二：启动程序**

```bash
# 双击运行
静默启动.vbs
```

---

## 使用指南

### 首次使用流程

**步骤1：启动程序**

**步骤2：学习手势**

- 点击"手势教学"按钮
- 学习8种标准手势
- 查看每种手势的功能说明

**步骤3：调整设置（可选）**

- 点击"系统设置"
- 调节鼠标灵敏度、音量步长等参数
- 测试摄像头是否正常工作

**步骤4：开始使用**

- 返回主界面，点击"启动手势控制"
- 在摄像头前做出标准手势
- 观察悬浮窗状态反馈

### 日常使用

```
步骤1：启动程序
        ↓
步骤2：点击"启动手势控制"
        ↓
步骤3：在摄像头前做手势
        ↓
步骤4：系统自动识别并执行操作
        ↓
步骤5：右键点击悬浮窗退出
```

---

## 手势操作详解

### 基础手势（所有模式通用）

#### 拳头（FIST）

- **动作说明**：五指全部弯曲成拳
- **主模式**：截图（自动保存到"图片/GestureScreenshots"）
- **浏览器模式**：持续向下滚动页面
- **音乐模式**：音量减小
- **识别难度**：低

#### 手掌（PALM）

- **动作说明**：五指全部伸直张开
- **主模式**：切换到鼠标模式
- **鼠标模式**：退出鼠标模式（返回主模式）
- **音乐模式**：退出音乐模式（返回主模式）
- **识别难度**：低

### 数字手势（1-4指）

#### 单指（ONE）

- **手势**：伸出食指，其余弯曲
- **主模式**：音量增加
- **鼠标模式**：控制鼠标移动（食指移动=鼠标移动）
- **浏览器模式**：刷新页面
- **音乐模式**：播放/暂停

#### 双指（TWO）

- **手势**：伸出食指和中指
- **主模式**：音量减小
- **鼠标模式**：左键单击
- **浏览器模式**：返回上一页
- **音乐模式**：下一首

#### 三指（THREE）

- **手势**：伸出食指、中指、无名指
- **主模式**：亮度增加
- **鼠标模式**：右键单击
- **浏览器模式**：前进下一页
- **音乐模式**：上一首

#### 四指（FOUR）

- **手势**：伸出除拇指外的四指
- **主模式**：亮度减小
- **鼠标模式**：双击
- **浏览器模式**：恢复关闭的标签页
- **音乐模式**：音量增加

### 特殊手势

#### 摇滚手势（ROCK）

- **手势**：伸出食指和小指（摇滚标志）
- **主模式**：截图（备用）
- **浏览器模式**：切换标签页

#### 点赞手势（THUMBS_UP）

- **手势**：拇指伸直向上，其余弯曲
- **浏览器模式**：持续向上滚动页面
- **音乐模式**：喜欢当前歌曲

---

## 配置说明

### 配置文件位置

- 主配置：`config.py`（系统默认配置）
- 用户配置：`user_settings.json`（用户自定义设置）

### 可调节参数

| 参数                  | 说明               | 默认值 | 调节范围 |
| --------------------- | ------------------ | ------ | -------- |
| `mouse_sensitivity` | 鼠标灵敏度         | 8.0    | 1.0-20.0 |
| `volume_step`       | 音量调节步长       | 0.05   | 0.01-0.2 |
| `brightness_step`   | 亮度调节步长       | 10     | 1-50     |
| `gesture_cooldown`  | 手势冷却时间（秒） | 0.5    | 0.1-2.0  |
| `scroll_speed`      | 浏览器滚动速度     | 5      | 1-20     |

---

## 项目结构

```
gesture-control-system/
├── launcher.py                      # 启动器（主入口）
├── main.py                          # 手势识别主程序
├── settings_ui.py                   # 设置界面
├── config.py                        # 配置文件
├── requirements.txt                 # 依赖列表
├── user_settings.json               # 用户设置
├── 静默启动.vbs                     # 静默启动脚本
│
│
├── gesture_controller/              # 核心模块
   ├── __init__.py                  # 模块导出
   ├── hand_tracker.py              # 手部追踪（MediaPipe）
   ├── gesture_recognizer.py        # 手势识别
   ├── action_executor.py           # 动作执行
   ├── status_window.py             # 状态悬浮窗
   ├── utils.py                     # 工具函数
   └── hand_landmarker.task         # MediaPipe模型

```

---

## 使用技巧

### 提高识别准确率

1. **环境光线**：确保光线充足且均匀，避免逆光
2. **背景简洁**：尽量使用纯色背景，减少干扰
3. **手部位置**：手距离摄像头30-60cm效果最佳
4. **手势标准**：尽量做出标准手势，手指分开明显
5. **保持稳定**：保持手势稳定1-2秒，等待系统识别

### 常见问题解决

#### Q1：摄像头无法启动？

**A**：

- 检查摄像头是否被其他程序占用
- 在设置界面测试摄像头
- 尝试修改 `camera_index`参数

#### Q2：手势识别不准确？

**A**：

- 调整环境光线
- 清洁摄像头镜头
- 调整 `FINGER_STATE_THRESHOLD`参数
- 尝试降低 `gesture_cooldown`值

#### Q3：某些功能无效？

**A**：

- 检查是否以管理员权限运行
- 确认系统支持（如亮度调节需要支持DDC/CI的显示器）
- 查看控制台错误信息

#### Q4：程序卡顿？

**A**：

- 降低摄像头分辨率
- 关闭其他占用CPU的程序
- 在设置中降低 `mouse_sensitivity`

---

## 故障排查

### 启动问题

**问题**：提示缺少模块

- **解决**：运行 `pip install -r requirements.txt`
- **解决**：运行 `一键设置.bat`自动安装依赖

### 运行问题

**问题**：MediaPipe模型下载失败

- **解决**：手动下载模型文件到 `gesture_controller/hand_landmarker.task`
- **下载地址**：`https://storage.googleapis.com/mediapipe-models/hand_landmarker/hand_landmarker/float16/1/hand_landmarker.task`

**问题**：手势无法识别

- **解决**：确保手部在摄像头视野内
- **解决**：检查是否有多个手同时出现（建议只检测一只手）
- **解决**：调整 `MIN_DETECTION_CONFIDENCE`参数

</div>
